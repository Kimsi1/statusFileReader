
<html class="no-js" lang="">

    <head>
      <meta charset="utf-8">
      <title>Packages</title>
      <meta name="description" content="">
      <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <meta name="theme-color" content="#fafafa">
      <style>
        table {
          
          font-family: helvetica;
          text-decoration: none;
          border-collapse: collapse;
          width: 100%;
        }
        
        td, th {
          border: 1px solid #dddddd;
          text-align: left;
          padding: 8px;
        }
        
        tr:nth-child(even) {
          background-color: #dddddd;
        }
        </style>
    </head>
    
    <body>
      <table>
        <tr>
          <th>Label</th>
          <th>Data</th>
          
        </tr>
        <tr>
          <td>Name:</td>
          <td id="name"></td>
          
        </tr>
        <tr>
          <td>Depends:</td>
          <td id="depends"></td>
        
        </tr>
        <tr>
          <td>Reverse depends:</td>
          <td id="revDepends"></td>
          
        </tr>
        <tr>
          <td>Description:</td>
          <td id="description"></td>
          
        </tr>
        
      </table>
      <script>
        
        let savePackageName=async(event, name)=>{
          event.preventDefault();
          let url = "http://localhost:3000/packages/"+name;
          fetch(url, {method: "POST"}).then(() => {
            location.href = event.target.href;
          });
        }



        const loadPackages = () => {
          fetch('http://localhost:3000/packages/name')
            .then((response) => {
              return response.json();
            })
            .then((myJson) => {
              console.log(myJson);
              console.log(myJson.depends.length)
              
              

              let name = document.getElementById("name");
              name.innerHTML = myJson.name;
              let description = document.getElementById("description");
              description.innerHTML = myJson.description;  
              
              let depends = document.getElementById("depends");
              if(myJson.depends==='No dependencies.'){
                depends.innerHTML = myJson.depends; 
              } else {
                for (let package of myJson.depends) {
                    const x = `
                        <p><a href="http://localhost:3000/packagehtml" onclick="javascript:savePackageName(event, '${package}')">${package}</a></p>
                    `
                    document.getElementById('depends').innerHTML = document.getElementById('depends').innerHTML + x;
                }
              }


              let revDepends = document.getElementById("revDepends");
              if(myJson.revDepends==='No reverse dependencies'){
                revDepends.innerHTML = myJson.revDepends;
              } else {
                for (let package of myJson.revDepends) {
                    const x = `
                        <p><a href="http://localhost:3000/packagehtml" onclick="javascript:savePackageName(event, '${package}')">${package}</a></p>
                    `
                    document.getElementById('revDepends').innerHTML = document.getElementById('revDepends').innerHTML + x;
                }
              }


              
          });

          
        }
        

        loadPackages();
        
      </script>
    </body>
    
    </html>